# 도메인 모델과 테이블 설계

**회원 주문 상품** : 회원은 여러 상품을 주문할 수 있다. 그리고 한 번 주문할 때 여러 상품을 선택할 수 있으므로 주문과 상품은 다대다.

**상품 분류** : 상품은 도서, 음반, 영화로 구분되는데 상품이라는 공통 속성을 사용하므로 상속 구조로 표현

![alt text](image.png)


## 엔티티 설계시 주의점

**가급적 setter를 사용하지말자**

## 모든 연관관계는 지연로딩 설정!

* 즉시로딩은 예측이 어렵고, 어떤 sql이 실행될지 추적하기 어렵다. N+1문제 발생

* 실무에서 모든 연관관계는 지연로딩
* 연관된 엔티티를 함께 db에 조회해야 하면, fetch join 또는 엔티티 그래프 기능을 사용
* `XToOne`관계는 기본이 즉시로딩이므로 직접 지연로딩으로 설정

**컬렉션은 필드에서 초기화**

컬렉션은 필드에서 바로 초기화 하는 것이 안전
* `null` 문제에서 안전
* 하이버네이트는 엔티티를 영속화 할 때, 컬랙션을 하이버네이트가 제공하는 내장 컬렉션으로 변경
